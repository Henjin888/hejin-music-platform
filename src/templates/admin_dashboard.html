<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éŸ³ä¹å¹³å°å†…å®¹å®¡æ ¸ç®¡ç†åå°</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Arial', sans-serif; background-color: #f5f5f5; }
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; text-align: center; }
        .container { max-width: 1200px; margin: 20px auto; padding: 0 20px; }
        .card { background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 20px; padding: 20px; }
        .btn { background: #667eea; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin: 5px; }
        .btn:hover { background: #5a67d8; }
        .btn-danger { background: #e53e3e; }
        .btn-danger:hover { background: #c53030; }
        .btn-success { background: #38a169; }
        .btn-success:hover { background: #2f855a; }
        .table { width: 100%; border-collapse: collapse; }
        .table th, .table td { padding: 12px; text-align: left; border-bottom: 1px solid #e2e8f0; }
        .table th { background-color: #edf2f7; font-weight: bold; }
        .status { padding: 4px 8px; border-radius: 12px; font-size: 12px; }
        .status-pending { background: #fef5e7; color: #744210; }
        .status-approved { background: #e6fffa; color: #234e52; }
        .status-rejected { background: #fed7d7; color: #742a2a; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: bold; }
        .form-group input, .form-group textarea, .form-group select { width: 100%; padding: 8px; border: 1px solid #e2e8f0; border-radius: 4px; }
        .nav { background: white; padding: 15px 0; border-bottom: 1px solid #e2e8f0; }
        .nav-item { display: inline-block; padding: 10px 20px; margin-right: 20px; cursor: pointer; border-radius: 5px; }
        .nav-item:hover { background: #edf2f7; }
        .nav-item.active { background: #667eea; color: white; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸµ éŸ³ä¹å¹³å°å†…å®¹å®¡æ ¸ç®¡ç†ç³»ç»Ÿ</h1>
        <p>ç¡®ä¿å¹³å°å†…å®¹åˆè§„ä¸ç”¨æˆ·å®‰å…¨</p>
    </div>

    <div class="container">
        <div class="nav">
            <div class="nav-item active" onclick="showTab('reports')">ä¸¾æŠ¥ç®¡ç†</div>
            <div class="nav-item" onclick="showTab('blacklist')">é»‘åå•ç®¡ç†</div>
            <div class="nav-item" onclick="showTab('music-audit')">éŸ³ä¹å®¡æ ¸</div>
            <div class="nav-item" onclick="showTab('content-filter')">å†…å®¹è¿‡æ»¤</div>
            <div class="nav-item" onclick="showTab('stats')">ç»Ÿè®¡ä¿¡æ¯</div>
        </div>

        <!-- ä¸¾æŠ¥ç®¡ç† -->
        <div id="reports" class="tab-content active">
            <div class="card">
                <h2>ğŸ“‹ ä¸¾æŠ¥åˆ—è¡¨</h2>
                <table class="table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>ä¸¾æŠ¥è€…</th>
                            <th>éŸ³ä¹ä½œå“</th>
                            <th>ä¸¾æŠ¥åŸå› </th>
                            <th>çŠ¶æ€</th>
                            <th>åˆ›å»ºæ—¶é—´</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="reports-list">
                        <tr>
                            <td colspan="7" style="text-align: center; padding: 40px; color: #666;">
                                æš‚æ— ä¸¾æŠ¥æ•°æ®ï¼Œè¯·ä½¿ç”¨APIåˆ›å»ºæµ‹è¯•æ•°æ®
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- é»‘åå•ç®¡ç† -->
        <div id="blacklist" class="tab-content">
            <div class="card">
                <h2>ğŸš« é»‘åå•ç®¡ç†</h2>
                
                <div style="margin-bottom: 20px;">
                    <h3>æ·»åŠ ç”¨æˆ·åˆ°é»‘åå•</h3>
                    <form id="add-blacklist-form" style="display: grid; grid-template-columns: 1fr 1fr 1fr auto; gap: 10px; align-items: end;">
                        <div class="form-group">
                            <label>ç”¨æˆ·ID</label>
                            <input type="number" id="blacklist-user-id" required>
                        </div>
                        <div class="form-group">
                            <label>å°ç¦åŸå› </label>
                            <input type="text" id="blacklist-reason" required>
                        </div>
                        <div class="form-group">
                            <label>ç»“æŸæ—¥æœŸ (å¯é€‰)</label>
                            <input type="datetime-local" id="blacklist-end-date">
                        </div>
                        <button type="submit" class="btn btn-danger">æ·»åŠ é»‘åå•</button>
                    </form>
                </div>

                <table class="table">
                    <thead>
                        <tr>
                            <th>ç”¨æˆ·</th>
                            <th>å°ç¦åŸå› </th>
                            <th>å¼€å§‹æ—¶é—´</th>
                            <th>ç»“æŸæ—¶é—´</th>
                            <th>çŠ¶æ€</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="blacklist-list">
                        <tr>
                            <td colspan="6" style="text-align: center; padding: 40px; color: #666;">
                                æš‚æ— é»‘åå•æ•°æ®
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- éŸ³ä¹å®¡æ ¸ -->
        <div id="music-audit" class="tab-content">
            <div class="card">
                <h2>ğŸµ éŸ³ä¹ä½œå“å®¡æ ¸</h2>
                
                <div style="margin-bottom: 20px;">
                    <h3>å¿«é€Ÿå®¡æ ¸</h3>
                    <form id="audit-form" style="display: grid; grid-template-columns: 1fr 1fr 2fr auto auto; gap: 10px; align-items: end;">
                        <div class="form-group">
                            <label>éŸ³ä¹ID</label>
                            <input type="number" id="audit-music-id" required>
                        </div>
                        <div class="form-group">
                            <label>å®¡æ ¸å†³å®š</label>
                            <select id="audit-action" required>
                                <option value="">é€‰æ‹©æ“ä½œ</option>
                                <option value="approve">é€šè¿‡</option>
                                <option value="reject">æ‹’ç»</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>å®¡æ ¸æ„è§</label>
                            <input type="text" id="audit-comment" placeholder="å¯é€‰">
                        </div>
                        <button type="submit" class="btn btn-success">æäº¤å®¡æ ¸</button>
                    </form>
                </div>
                
                <div style="background: #f7fafc; padding: 15px; border-radius: 8px; border-left: 4px solid #4299e1;">
                    <h4>ğŸ“ å®¡æ ¸æŒ‡å¼•</h4>
                    <ul style="margin-top: 10px; padding-left: 20px;">
                        <li>æ£€æŸ¥éŸ³ä¹å†…å®¹æ˜¯å¦ç¬¦åˆå¹³å°è§„èŒƒ</li>
                        <li>ç¡®è®¤æ— ç‰ˆæƒçº çº·æˆ–è¿è§„å†…å®¹</li>
                        <li>è¯„ä¼°éŸ³ä¹è´¨é‡å’Œç”¨æˆ·ä½“éªŒ</li>
                        <li>å¦‚æœ‰ç–‘é—®ï¼Œå¯æ ‡è®°ä¸ºéœ€è¦è¿›ä¸€æ­¥å®¡æ ¸</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- å†…å®¹è¿‡æ»¤ -->
        <div id="content-filter" class="tab-content">
            <div class="card">
                <h2>ğŸ” å†…å®¹è¿‡æ»¤ç®¡ç†</h2>
                
                <div style="margin-bottom: 20px;">
                    <h3>æ·»åŠ è¿‡æ»¤è§„åˆ™</h3>
                    <form id="filter-form" style="display: grid; grid-template-columns: 2fr 1fr 1fr auto; gap: 10px; align-items: end;">
                        <div class="form-group">
                            <label>å…³é”®è¯</label>
                            <input type="text" id="filter-keyword" required>
                        </div>
                        <div class="form-group">
                            <label>è¿‡æ»¤èŒƒå›´</label>
                            <select id="filter-type" required>
                                <option value="">é€‰æ‹©èŒƒå›´</option>
                                <option value="title">ä»…æ ‡é¢˜</option>
                                <option value="description">ä»…æè¿°</option>
                                <option value="both">æ ‡é¢˜å’Œæè¿°</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>å¤„ç†åŠ¨ä½œ</label>
                            <select id="filter-action" required>
                                <option value="">é€‰æ‹©åŠ¨ä½œ</option>
                                <option value="block">ç›´æ¥é˜»æ­¢</option>
                                <option value="flag">æ ‡è®°å®¡æ ¸</option>
                                <option value="moderate">äººå·¥å®¡æ ¸</option>
                            </select>
                        </div>
                        <button type="submit" class="btn">æ·»åŠ è§„åˆ™</button>
                    </form>
                </div>

                <div style="background: #fef5e7; padding: 15px; border-radius: 8px; border-left: 4px solid #ed8936;">
                    <h4>âš ï¸ æ³¨æ„äº‹é¡¹</h4>
                    <p style="margin-top: 10px;">è¿‡æ»¤è§„åˆ™å°†è‡ªåŠ¨åº”ç”¨åˆ°æ–°ä¸Šä¼ çš„å†…å®¹ã€‚è¯·è°¨æ…è®¾ç½®å…³é”®è¯ï¼Œé¿å…è¯¯æ€æ­£å¸¸å†…å®¹ã€‚</p>
                </div>
            </div>
        </div>

        <!-- ç»Ÿè®¡ä¿¡æ¯ -->
        <div id="stats" class="tab-content">
            <div class="card">
                <h2>ğŸ“Š å¹³å°å®¡æ ¸ç»Ÿè®¡</h2>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px; text-align: center;">
                        <h3 style="font-size: 24px;">å¾…å¤„ç†ä¸¾æŠ¥</h3>
                        <p style="font-size: 36px; margin: 10px 0;" id="pending-reports">-</p>
                    </div>
                    <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 20px; border-radius: 8px; text-align: center;">
                        <h3 style="font-size: 24px;">é»‘åå•ç”¨æˆ·</h3>
                        <p style="font-size: 36px; margin: 10px 0;" id="blacklisted-users">-</p>
                    </div>
                    <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; padding: 20px; border-radius: 8px; text-align: center;">
                        <h3 style="font-size: 24px;">ä»Šæ—¥å®¡æ ¸</h3>
                        <p style="font-size: 36px; margin: 10px 0;" id="today-audits">-</p>
                    </div>
                    <div style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white; padding: 20px; border-radius: 8px; text-align: center;">
                        <h3 style="font-size: 24px;">è¿‡æ»¤è§„åˆ™</h3>
                        <p style="font-size: 36px; margin: 10px 0;" id="filter-rules">-</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å¯¼èˆªåˆ‡æ¢
        function showTab(tabName) {
            // éšè—æ‰€æœ‰æ ‡ç­¾é¡µ
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾é¡µ
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // APIè°ƒç”¨è¾…åŠ©å‡½æ•°
        function apiCall(endpoint, method = 'GET', data = null) {
            const options = {
                method: method,
                headers: {
                    'Content-Type': 'application/json',
                }
            };
            
            if (data) {
                options.body = JSON.stringify(data);
            }
            
            return fetch('/api' + endpoint, options);
        }

        // æ·»åŠ é»‘åå•è¡¨å•
        document.getElementById('add-blacklist-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const userId = document.getElementById('blacklist-user-id').value;
            const reason = document.getElementById('blacklist-reason').value;
            const endDate = document.getElementById('blacklist-end-date').value;
            
            const data = {
                user_id: parseInt(userId),
                reason: reason
            };
            
            if (endDate) {
                data.end_date = endDate;
            }
            
            try {
                const response = await apiCall('/blacklist/add', 'POST', data);
                const result = await response.json();
                
                if (result.success) {
                    alert('ç”¨æˆ·å·²æˆåŠŸæ·»åŠ åˆ°é»‘åå•');
                    this.reset();
                } else {
                    alert('æ“ä½œå¤±è´¥: ' + result.message);
                }
            } catch (error) {
                alert('ç½‘ç»œé”™è¯¯ï¼Œè¯·æ£€æŸ¥æ˜¯å¦å·²ç™»å½•å¹¶å…·æœ‰ç®¡ç†å‘˜æƒé™');
            }
        });

        // éŸ³ä¹å®¡æ ¸è¡¨å•
        document.getElementById('audit-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const musicId = document.getElementById('audit-music-id').value;
            const action = document.getElementById('audit-action').value;
            const comment = document.getElementById('audit-comment').value;
            
            const data = {
                action: action,
                comment: comment || ''
            };
            
            try {
                const response = await apiCall(`/music/${musicId}/audit`, 'POST', data);
                const result = await response.json();
                
                if (result.success) {
                    alert('å®¡æ ¸ç»“æœå·²æäº¤');
                    this.reset();
                } else {
                    alert('æ“ä½œå¤±è´¥: ' + result.message);
                }
            } catch (error) {
                alert('ç½‘ç»œé”™è¯¯ï¼Œè¯·æ£€æŸ¥æ˜¯å¦å·²ç™»å½•å¹¶å…·æœ‰ç®¡ç†å‘˜æƒé™');
            }
        });

        // å†…å®¹è¿‡æ»¤è¡¨å•
        document.getElementById('filter-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const keyword = document.getElementById('filter-keyword').value;
            const filterType = document.getElementById('filter-type').value;
            const action = document.getElementById('filter-action').value;
            
            const data = {
                keyword: keyword,
                filter_type: filterType,
                action: action
            };
            
            try {
                const response = await apiCall('/content-filter/add', 'POST', data);
                const result = await response.json();
                
                if (result.success) {
                    alert('è¿‡æ»¤è§„åˆ™å·²æ·»åŠ ');
                    this.reset();
                } else {
                    alert('æ“ä½œå¤±è´¥: ' + result.message);
                }
            } catch (error) {
                alert('ç½‘ç»œé”™è¯¯ï¼Œè¯·æ£€æŸ¥æ˜¯å¦å·²ç™»å½•å¹¶å…·æœ‰ç®¡ç†å‘˜æƒé™');
            }
        });

        // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºè¯´æ˜
        window.addEventListener('load', function() {
            alert('ğŸ‘‹ æ¬¢è¿ä½¿ç”¨éŸ³ä¹å¹³å°å†…å®¹å®¡æ ¸ç®¡ç†ç³»ç»Ÿï¼\n\nâš ï¸ æ³¨æ„ï¼š\n1. æ­¤ä¸ºæ¼”ç¤ºç•Œé¢ï¼Œéœ€è¦å…ˆé€šè¿‡APIè¿›è¡Œç”¨æˆ·è®¤è¯\n2. ç®¡ç†å‘˜æƒé™ä¸ºå¿…éœ€\n3. å¯ä»¥é€šè¿‡APIåˆ›å»ºæµ‹è¯•æ•°æ®è¿›è¡ŒåŠŸèƒ½éªŒè¯\n4. å®Œæ•´åŠŸèƒ½éœ€è¦é…åˆåç«¯APIä½¿ç”¨');
        });
    </script>
</body>
</html>